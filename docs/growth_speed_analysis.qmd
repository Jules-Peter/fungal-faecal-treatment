---
title: "Growth speed analysis"
format: html
editor: visual
---

## Growth speed analysis

This file is for analyzing the data for growth speed analysis of different fungal species on faeces.

```{r}
#| echo: false # Hide code
#| results: hide # Hide text output
#| include: false # Hide plots

library("tidyverse")
library("knitr")
library("rstatix")
library("multcomp")
library("broom.mixed")
library("dplyr")
library("gt")

knitr::opts_knit$set(root.dir = ("../data"))
growth_speed_vs_species <-read.csv("../data/processed/growth_speed_analysis.csv")
```

## How will the data be analysed

Showing growth speed depending on time

The growth speed daily increase will be plotted for as growth curves from day 0 to day 14. This will show if the growth speed increases over time or if it stay constant.

```{r}
#|echo: false
time_curve_plot <- ggplot(growth_speed_analysis_long, aes(x = time_period, y = difference, color = species, group = interaction(species, id_treatment))) + # group aesthetic needed if you have multiple replicates per species plotted directly
  geom_line() +       # Draw lines connecting points for each species
  geom_point() +      # Optional: Add points to show the exact data points
  labs(
    title = "Growth Difference Over Time by Species",
    x = "Time days post inoculation [dpi]",
    y = "Growth rate [cm^2/day]",
    color = "Species"  # Legend title
  ) +
  theme_classic() 
time_curve_plot
```

Show average growth speed per species over the replicates

```{r}
#|echo: false

#### calculate mean of an experiment
growth_speed_analysis|>
   filter(species != "ctrl")

ggplot(growth_speed_analysis,
       mapping=aes(x=species, y=mean_growth_speed))+
  labs(
    title = "Mean growthspeed by Species",
    x = "Species",
    y ="Growth rate [cm^2/day]",
    color = "Species") +
  geom_boxplot()
```

Testing for normal distribution of the mean growth speed

```{r}
#| echo: false

###Testing data for normal distribution e_coli 
normality_mean_growth_speed <- growth_speed_species_mean |>
  dplyr::select(species, mean_growth_speed)

shapiro_mean_growth_speed <- normality_mean_growth_speed |>
  group_by(species)|>
  shapiro_test(mean_growth_speed)

mean_growth_speed|>
  gt()

###qq-plot for each species 
ggplot(mean_growth_speed, aes(sample = `mean_growth_speed`)) +
  geom_qq() +
  facet_wrap(vars( species)) +
  geom_qq_line(color = "purple")
```

Show average growth speed according to substrate used for inoculum

```{r}
#|echo: false

### use mean to compare between the species, each replicate is represented by it is mean in the box plot

growth_speed_species_mean|>
  filter(species != "ctrl")

ggplot(growth_speed_species_mean,
       mapping=aes(x=species, y=mean_growth_speed, fill= material))+
  labs(
    title = "Mean growthspeed by Species",
    x = "Species",
    y ="Growth rate [cm^2/day]",
    color = "Species") +
  geom_boxplot()


```

## Growth speed by Inoculum substrate

Show substrate growth speed for single species on different substrates

```{r}
#|echo: false

### use mean to compare between the species, each replicate is represented by it is mean in the box plot

growth_speed_species_mean_postreatus<- growth_speed_analysis|>
  filter(species == "P. ostreatus")

ggplot(growth_speed_species_mean_postreatus,
       mapping=aes(x=material,
                   y=mean_growth_speed, fill=species))+ ### add fill with weight if different wheights are used
  labs(
    title = "Mean growthspeed by inoculum material",
    x = "Inoculum material",
    y ="Growth rate [cm^2/day]",
    color = "Species") +
  geom_boxplot()

###Repeat for other species of interest merge together if desired

ggplot(growth_speed_analysis,
       mapping=aes(x=material, y= mean_growth_speed,
                   group = interaction(species, material)))+
       geom_boxplot()

# Assuming your data frame is named 'your_data'
# and has columns 'species', 'material', and 'mean_growth_speed'

ggplot(growth_speed_analysis, aes(x = species, y = mean_growth_speed, fill = material)) +
  geom_boxplot() +
  facet_grid(~ species, scales = "free_x", space = "free_x") +
  theme(axis.text.x = element_blank(),
        axis.ticks.x = element_blank(),
        strip.text.x = element_text(face = "bold")) +
  labs(title = "Mean Growth Speed by Species and Material",
       x = "Species",
       y = "Mean Growth Speed",
       fill = "Material")

### Shown depending on Inoculum age make categories depending on age >20 <20 ...
ggplot(growth_speed_analysis, aes(x = species, y = mean_growth_speed, fill = inoculum_age)) +
  geom_boxplot() +
  facet_grid(~ species, scales = "free_x", space = "free_x") +
  theme(axis.text.x = element_blank(),
        axis.ticks.x = element_blank(),
        strip.text.x = element_text(face = "bold")) +
  labs(title = "Mean Growth Speed by Species and Material",
       x = "Species",
       y = "Mean Growth Speed",
       fill = "Inoculum Age")


```
